<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title> {% block title %} DMS {% endblock %}</title>
    {% load staticfiles %}
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <link href='https://fonts.googleapis.com/css?family=Satisfy' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="{% static 'DMS/style.css' %}"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <link rel="stylesheet"
          href="http://www.orangehilldev.com/jstree-bootstrap-theme/demo/assets/dist/themes/proton/style.css"/>

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>


    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/jstree/3.0.9/themes/default/style.min.css"/>


    <script src="//cdnjs.cloudflare.com/ajax/libs/jstree/3.0.9/jstree.min.js"></script>


</head>


<body>

<nav class="navbar navbar-inverse">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#topNavBar">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>

            </button>

        </div>

        <!--Items-->
        <div class="collapse navbar-collapse" id="topNavBar">

            <a href="http://127.0.0.1:8000/DMS/index" class="navbar-brand">Document management application</a>

            <form class="navbar-form navbar-left" role="search" method="get" action="#">
                <div class="form-group">
                    <input type="text" class="form-control" name="q" value="{{ request.GET.q }}">

                </div>
                <button type="submit" class="btn btn-default">Search</button>

            </form>


            <ul class="nav navbar-nav navbar-right">

                <li class="">
                    <a href="{% url 'DMS:create-folder' %}">
                        <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>&nbsp; Add Folder
                    </a>
                </li>
                <ul class="nav navbar-nav">
                    <li class="navbar-brand">
                        <span class="glyphicon glyphicon-user"> </span> {{ request.user.first_name }}
                    </li>

                </ul>
                <li class="">
                    <a href="{% url 'DMS:user_login' %}">
                        <span class="glyphicon glyphicon-off" aria-hidden="true"></span>&nbsp; Logout
                    </a>
                </li>


            </ul>


        </div>

    </div>

    </div>
</nav>

<!-- Left Folder Info -->
<div class="col-sm-4 col-md-3">

    <div class="panel panel-default">

        <div class="panel-body">

            <div id="myTree" class="using_events">
                <script>
                    $(function () {
                        $('.using_events')
                            .on('changed.jstree', function (e, data) {
                                var i, j, r = [], f;

                                for (i = 0, j = data.selected.length; i < j; i++) {
                                    r.push(data.instance.get_node([data.selected[i]]).text);
                                    var nm = r.toString();

                                    {% for f in folder_name %}
                                        if (nm === "{{ f.name }}")
                                            {#                                            console.log('Selected: ' + {{ f.id }});#}
                                            {#                                            window.location.href= "http://127.0.0.1:8000/DMS/" + {{ f.id }};#}
                                            window.location.href = "http://127.0.0.1:8000/DMS/" + {{ f.id }};

                                    {% endfor %}

                                }

                                {#                                console.log('Selected: ' + r);#}
                                {#                                window.location.href("http://127.0.0.1:8000/DMS/first" + r.join(', '));#}

                                {#									$('#event_result').html('Selected:<br /> ' + r.join(', '));#}
                            })
                            .jstree();
                    });
                </script>


            </div>


        </div>

    </div>

</div>


<script>
    {#{ "id" : "ajson1", "parent" : "#", "text" : "Simple root node" },#}
    $('#myTree')
    // create the instance
        .jstree({
            'core': {
                'data': [
                    {% for folder in folder_name %}

                        {
                            "id": "{{ folder.name }}", {% if folder.root == "root" %}"parent" : '#',
                            {% else %}"parent": "{{ folder.root }}",
                        {% endif %}
                            "text": "{{ folder.name }}"
                        },
                    {% endfor %}
                ]

            }
        });

</script>

{% block body %}
{% endblock %}

</body>
</html>